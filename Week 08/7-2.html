<script>
	function match(str) {
		let state = start;
		for (const s of str) {
			state = state(s);
		}
		return state === end;
	}

	function start(s) {
		if (s === 'a') {
			return foundA1;
		}
		return start;
	}

	function end(s) {
		return end;
	}

	function foundA1(s) {
		if (s === 'b') {
			return foundB1;
		}
		return start(s);
	}

	function foundB1(s) {
		if (s === 'c') {
			return foundC;
		}
		return start(s);
	}

	function foundC(s) {
		if (s === 'a') {
			return foundA2;
		}
		return start(s);
	}

	function foundA2(s) {
		if (s === 'b') {
			return foundB2;
		}
		return start(s);
	}

	function foundB2(s) {
		if (s === 'x') {
			return end;
		}
		return foundB1(s);
	}

	console.log(match('abcabcabx'));
</script>
